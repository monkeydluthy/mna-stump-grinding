[build]
  command = "cd frontend && npm install && npm run build && cd ../netlify/functions && npm install"
  publish = "frontend/dist"
  functions = "netlify/functions"

# API routes must come BEFORE the catch-all
# Using force = true to ensure this takes precedence over catch-all
[[redirects]]
  from = "/api/reviews/google"
  to = "/.netlify/functions/reviews-google"
  status = 200
  force = true

[[redirects]]
  from = "/api/portfolio"
  to = "/.netlify/functions/portfolio"
  status = 200
  force = true

[[redirects]]
  from = "/api/auth/*"
  to = "/.netlify/functions/auth"
  status = 200
  force = true

[[redirects]]
  from = "/api/upload"
  to = "/.netlify/functions/upload"
  status = 200
  force = true

# Catch-all for SPA routing - must be last
[[redirects]]
  from = "/*"
  to = "/index.html"
  status = 200

